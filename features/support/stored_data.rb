events = <<-JSON
{
  "results":[ {
        "utc_offset":-25200000,
        "venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
        "headcount":0,
        "visibility":"public",
        "waitlist_count":0,
        "created":1420575569000,
        "maybe_rsvp_count":0,
        "description":"<p>Join us for three days in April at the Market Street Prototyping Festival when Market Street will come alive as a public platform to test over 50 innovative ideas to improve San Francisco’s civic spine. Nature in the City is pleased to provide nature-based programming with <i>Market Street as Habitat </i>in conjunction with the Studio for Urban Projects <b>Outpost </b>prototype. </p> <p>Now, let’s take a cue from the butterfly! It’s remarkable, really, how the Western Tiger Swallowtail has found a home on San Francisco’s Market Street. And it’s not alone. Come participate in a festival of events—from citizen science bioblitzing, to mothing on Market Street, to planting workshops, wildlife tours, and outdoor play—to inspire you to discover the wilder side of Market Street. Also you’re in for a very special treat! We have just published a field guide to Market Street, and copies will be available for the first time here! </p> <p>Though it may seem that Market Street is devoid of wild creatures, the Western Tiger Swallowtail soars in abundance high in the canopy of the London Plane trees where they lay their eggs. What’s missing for this butterfly, however, are flowering plants to sustain their adult flight. So in our planting workshop, we’ll provide critical nectar sources for us to plant together! After all, Market Street is a habitat for us all. </p> <p><b>Event Schedule</b>: </p> <p><i><b>Market Street as Habitat</b></i> at the <i><b>Outpost </b></i>April 9-11, 2015 (Prototype located on the north side of Market Street between 6th and 7th)</p> <p><b><i>Market Street as Habitat</i> </b>program: </p> <p>Thursday, 11 a.m. to 3 p.m. Resident naturalist Peter Brastow on local biodiversity</p> <p>Thursday, 9 p.m. Resident naturalist Ken-ichi Ueda at the moth light</p> <p>Friday, 11 a.m. to 3 p.m. Resident naturalists Sarah McConnico and Amber Hasselbring nectar planting workshop</p> <p>Saturday, 7 a.m. Resident naturalist for a morning bird walk</p> <p>Saturday, 10 a.m. Nerds on Safari Bioblitz with Nerds for Nature, iNaturalist, California Academy of Sciences, and you</p> <p>Saturday, 1 p.m. Catalog and share our Bioblitz sightings</p> <p>Saturday, 5 p.m. Resident Naturalist Amber Hasselbring <i><b>Tigers on Market Street</b></i> naturalist talk</p> <p><b>More info</b>: </p> <p>Nerds on Safari Bioblitz information here:</p>",
        "how_to_find_us":"Look for us at Market Street as Habitat at the Outpost April 9-11, 2015 (Prototype located on the north side of Market Street between 6th and 7th)",
        "event_url":"http://www.meetup.com/Nature-in-the-City/events/219648262/",
        "yes_rsvp_count":4,
        "duration":284400000,
        "name":"Market Street Prototyping Festival",
        "id":"219648262",
        "time":1428602400000,
        "updated":1428000888000,
        "group":{"join_mode":"open","created":1370892745000,"name":"Nature in the City","group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668,"who":"Urban Naturalists"},
        "status":"upcoming"},
        {"utc_offset":-25200000,
        "venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
        "headcount":0,
        "visibility":"public",
        "waitlist_count":0,
        "created":1424706451000,
        "maybe_rsvp_count":0,
        "description":"<p>Join us in San Francisco's downtown during the Market Street Prototyping Festival, for a grassroots, smartphone-powered bioblitz to catalogue every living species we can identify from from the Embarcadero to Civic Center and all parks and plazas in between!</p> <p>We will be blitzing from the wee hours until after dark. Meet us at 10:00 AM for the public portion of the bioblitz.</p> <p><br/><b>The public bioblitz:</b></p> <p>Meet at Sidewalk Prototype in front of The Hall at 1028 Market Street, San Francisco, at <b>10 AM sharp</b> to begin the daytime portion of the blitz. Meet again at <b>1 PM sharp</b> to share our discoveries. </p> <p>Bring your smartphone and/or a camera, your curiosity, and tons of enthusiasm. We’ll rally some experts and folks who specialize in deep urban ecology. Together we’ll make some great discoveries, have fun, and get to know these places and each other better.</p> <p>A bioblitz is an intensive one-day study of biodiversity in a specific location, bringing scientists and volunteer citizen-scientists together. Together we’ll look for sidewalk weeds, snails, flies, birds, mammals, butterflies and moths, other insects, spiders, trees, worms, flowers, and everything else we can find.</p> <p>People of all ages and skill levels are welcome! Bring your smart phone for sure. Bonus: camera, binoculars, and magnifying glasses. We’ll enter observations in iNaturalist and join together at the end to find out how many observations we made and how many species we found. Past blitzes in Oakland, San Francisco, and San Mateo have averaged 1000 observations and 200+ species each.</p> <p>Don't have an iNaturalist account yet? No problem! Download the iNaturalist app on iPhone, Android, sign up for an account, then make a few practice observations.</p> <p>Brought to you by Nature in the City, Studio for Urban Projects, Nerds for Nature, and iNaturalist.</p> <p>Registration:</p>",
        "event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/",
        "yes_rsvp_count":4,
        "duration":86400000,
        "name":"Nerds on Safari: Market Street",
        "id":"220706208",
        "time":1428735600000,
        "updated":1426276899000,
        "group":{"join_mode":"open","created":1370892745000,"name":"Nature in the City","group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668,"who":"Urban Naturalists"},
        "status":"upcoming"},
        {"utc_offset":-25200000,
        "venue":{"zip":"94117","country":"us","city":"San Francisco","address_1":"Waller St. & Buena Vista Ave. East, San Francisco, CA","name":"Adah Bakalinsky Steps","lon":-122.439178,"id":16380832,"state":"CA","lat":37.769981,"repinned":false},
        "headcount":0,
        "visibility":"public",
        "waitlist_count":0,
        "created":1382735648000,
        "maybe_rsvp_count":0,
        "description":"<p>The <b>Adah Bakalinsky Steps</b> is a new community partnership, a public park located in the Buena Vista Park and Haight Ashbury neighborhoods. Nature in the City is working with neighborhood residents to enhance the beauty and wildlife potential of this park–which had become blighted by illegal dumping and graffiti. </p> <p>We are helping to organize the community and facilitate monthly volunteer work to transform this area into a tribute to local walking guru Adah Bakalinsky and a quiet contemplative space with a view of the San Francisco skyline. Our work here is also dedicated to the Cedar Waxwing (<i>Bombycilla cedrorum</i>), a gorgeous bird, which passes through San Francisco twice a year in heavy flocks feeding on plants and shrubs that are laden with berries and fruits along its way.</p>",
        "how_to_find_us":"This public park is located as if Waller Street continued up the hill from Broderick Street to Buena Vista Avenue East. You'll find us working here in the park, come say hello!",
        "event_url":"http://www.meetup.com/Nature-in-the-City/events/214161012/",
        "yes_rsvp_count":1,
        "duration":7200000,
        "name":"Volunteer at the Adah Bakalinsky Steps!",
        "id":"dmlzzgytgbzb",
        "time":1429462800000,
        "updated":1407183333000,
        "group":{"join_mode":"open","created":1370892745000,"name":"Nature in the City","group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668,"who":"Urban Naturalists"},
        "status":"upcoming"}],
"meta":{"next":"",
        "method":"Events",
        "total_count":3,
        "link":"https://api.meetup.com/2/events",
        "count":3,
        "description":"Access Meetup events using a group, member, or event id. Events in private groups are available only to authenticated members of those groups. To search events by topic or location, see [Open Events](/meetup_api/docs/2/open_events).",
        "lon":"",
        "title":"Meetup Events v2",
        "url":"https://api.meetup.com/2/events?offset=0&format=json&limited_events=False&event_id=220706208%2C219648262%2C214161012&page=200&fields=&key=2921522134e105851666a55e6d2616&order=time&desc=false&status=upcoming",
        "id":"",
        "updated":1428000888000,
        "lat":""}}
JSON

modified_events = <<-JSON
{
  "results":[ {
        "utc_offset":-25200000,
        "venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
        "headcount":0,
        "visibility":"public",
        "waitlist_count":0,
        "created":1420575569000,
        "maybe_rsvp_count":0,
        "description":"<p>Join us for three days in April at the Market Street Prototyping Festival when Market Street will come alive as a public platform to test over 50 innovative ideas to improve San Francisco’s civic spine. Nature in the City is pleased to provide nature-based programming with <i>Market Street as Habitat </i>in conjunction with the Studio for Urban Projects <b>Outpost </b>prototype. </p> <p>Now, let’s take a cue from the butterfly! It’s remarkable, really, how the Western Tiger Swallowtail has found a home on San Francisco’s Market Street. And it’s not alone. Come participate in a festival of events—from citizen science bioblitzing, to mothing on Market Street, to planting workshops, wildlife tours, and outdoor play—to inspire you to discover the wilder side of Market Street. Also you’re in for a very special treat! We have just published a field guide to Market Street, and copies will be available for the first time here! </p> <p>Though it may seem that Market Street is devoid of wild creatures, the Western Tiger Swallowtail soars in abundance high in the canopy of the London Plane trees where they lay their eggs. What’s missing for this butterfly, however, are flowering plants to sustain their adult flight. So in our planting workshop, we’ll provide critical nectar sources for us to plant together! After all, Market Street is a habitat for us all. </p> <p><b>Event Schedule</b>: </p> <p><i><b>Market Street as Habitat</b></i> at the <i><b>Outpost </b></i>April 9-11, 2015 (Prototype located on the north side of Market Street between 6th and 7th)</p> <p><b><i>Market Street as Habitat</i> </b>program: </p> <p>Thursday, 11 a.m. to 3 p.m. Resident naturalist Peter Brastow on local biodiversity</p> <p>Thursday, 9 p.m. Resident naturalist Ken-ichi Ueda at the moth light</p> <p>Friday, 11 a.m. to 3 p.m. Resident naturalists Sarah McConnico and Amber Hasselbring nectar planting workshop</p> <p>Saturday, 7 a.m. Resident naturalist for a morning bird walk</p> <p>Saturday, 10 a.m. Nerds on Safari Bioblitz with Nerds for Nature, iNaturalist, California Academy of Sciences, and you</p> <p>Saturday, 1 p.m. Catalog and share our Bioblitz sightings</p> <p>Saturday, 5 p.m. Resident Naturalist Amber Hasselbring <i><b>Tigers on Market Street</b></i> naturalist talk</p> <p><b>More info</b>: </p> <p>Nerds on Safari Bioblitz information here:</p>",
        "how_to_find_us":"Look for us at Market Street as Habitat at the Outpost April 9-11, 2015 (Prototype located on the north side of Market Street between 6th and 7th)",
        "event_url":"http://www.meetup.com/Nature-in-the-City/events/219648262/",
        "yes_rsvp_count":4,
        "duration":284400000,
        "name":"Prototyping Festival",
        "id":"219648262",
        "time":1428602400000,
        "updated":1528000888000,
        "group":{"join_mode":"open","created":1370892745000,"name":"Nature in the City","group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668,"who":"Urban Naturalists"},
        "status":"upcoming"},
        {"utc_offset":-25200000,
        "venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
        "headcount":0,
        "visibility":"public",
        "waitlist_count":0,
        "created":1424706451000,
        "maybe_rsvp_count":0,
        "description":"<p>Join us in San Francisco's downtown during the Market Street Prototyping Festival, for a grassroots, smartphone-powered bioblitz to catalogue every living species we can identify from from the Embarcadero to Civic Center and all parks and plazas in between!</p> <p>We will be blitzing from the wee hours until after dark. Meet us at 10:00 AM for the public portion of the bioblitz.</p> <p><br/><b>The public bioblitz:</b></p> <p>Meet at Sidewalk Prototype in front of The Hall at 1028 Market Street, San Francisco, at <b>10 AM sharp</b> to begin the daytime portion of the blitz. Meet again at <b>1 PM sharp</b> to share our discoveries. </p> <p>Bring your smartphone and/or a camera, your curiosity, and tons of enthusiasm. We’ll rally some experts and folks who specialize in deep urban ecology. Together we’ll make some great discoveries, have fun, and get to know these places and each other better.</p> <p>A bioblitz is an intensive one-day study of biodiversity in a specific location, bringing scientists and volunteer citizen-scientists together. Together we’ll look for sidewalk weeds, snails, flies, birds, mammals, butterflies and moths, other insects, spiders, trees, worms, flowers, and everything else we can find.</p> <p>People of all ages and skill levels are welcome! Bring your smart phone for sure. Bonus: camera, binoculars, and magnifying glasses. We’ll enter observations in iNaturalist and join together at the end to find out how many observations we made and how many species we found. Past blitzes in Oakland, San Francisco, and San Mateo have averaged 1000 observations and 200+ species each.</p> <p>Don't have an iNaturalist account yet? No problem! Download the iNaturalist app on iPhone, Android, sign up for an account, then make a few practice observations.</p> <p>Brought to you by Nature in the City, Studio for Urban Projects, Nerds for Nature, and iNaturalist.</p> <p>Registration:</p>",
        "event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/",
        "yes_rsvp_count":4,
        "duration":86400000,
        "name":"Nerds on Safari: Market Street",
        "id":"220706208",
        "time":1428735600000,
        "updated":1426276899000,
        "group":{"join_mode":"open","created":1370892745000,"name":"Nature in the City","group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668,"who":"Urban Naturalists"},
        "status":"upcoming"},
        {"utc_offset":-25200000,
        "venue":{"zip":"94117","country":"us","city":"San Francisco","address_1":"Waller St. & Buena Vista Ave. East, San Francisco, CA","name":"Adah Bakalinsky Steps","lon":-122.439178,"id":16380832,"state":"CA","lat":37.769981,"repinned":false},
        "headcount":0,
        "visibility":"public",
        "waitlist_count":0,
        "created":1382735648000,
        "maybe_rsvp_count":0,
        "description":"<p>The <b>Adah Bakalinsky Steps</b> is a new community partnership, a public park located in the Buena Vista Park and Haight Ashbury neighborhoods. Nature in the City is working with neighborhood residents to enhance the beauty and wildlife potential of this park–which had become blighted by illegal dumping and graffiti. </p> <p>We are helping to organize the community and facilitate monthly volunteer work to transform this area into a tribute to local walking guru Adah Bakalinsky and a quiet contemplative space with a view of the San Francisco skyline. Our work here is also dedicated to the Cedar Waxwing (<i>Bombycilla cedrorum</i>), a gorgeous bird, which passes through San Francisco twice a year in heavy flocks feeding on plants and shrubs that are laden with berries and fruits along its way.</p>",
        "how_to_find_us":"This public park is located as if Waller Street continued up the hill from Broderick Street to Buena Vista Avenue East. You'll find us working here in the park, come say hello!",
        "event_url":"http://www.meetup.com/Nature-in-the-City/events/214161012/",
        "yes_rsvp_count":1,
        "duration":7200000,
        "name":"Volunteer at the Adah Bakalinsky Steps!",
        "id":"dmlzzgytgbzb",
        "time":1429462800000,
        "updated":1407183333000,
        "group":{"join_mode":"open","created":1370892745000,"name":"Nature in the City","group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668,"who":"Urban Naturalists"},
        "status":"upcoming"}],
"meta":{"next":"",
        "method":"Events",
        "total_count":3,
        "link":"https://api.meetup.com/2/events",
        "count":3,
        "description":"Access Meetup events using a group, member, or event id. Events in private groups are available only to authenticated members of those groups. To search events by topic or location, see [Open Events](/meetup_api/docs/2/open_events).",
        "lon":"",
        "title":"Meetup Events v2",
        "url":"https://api.meetup.com/2/events?offset=0&format=json&limited_events=False&event_id=220706208%2C219648262%2C214161012&page=200&fields=&key=2921522134e105851666a55e6d2616&order=time&desc=false&status=upcoming",
        "id":"",
        "updated":1528000888000,
        "lat":""}}
JSON

third_party_event = <<-JSON
{"results":[{"utc_offset":-25200000,
             "venue":{"country":"us","city":"San Francisco, 94108","address_1":"1111 California St. ","name":"The Masonic ","lon":-122.412956,"id":22529952,"state":"CA","lat":37.791183,"repinned":false},
             "headcount":0,
             "visibility":"public",
             "waitlist_count":0,
             "created":1424581842000,
             "rating":{"count":0,"average":0},
             "maybe_rsvp_count":0,
             "description": "<p>Great band, cheap ticket price, what's not to like?<br/></p>",
             "event_url":"http://www.meetup.com/LiveMusicSF/events/220680184/",
             "yes_rsvp_count":22,
             "name":"Walk the Moon",
             "id":"220680184",
             "time":1426384800000,
             "updated":1426396186000,
             "group":{"join_mode":"open","created":1270427879000,"name":"Live Music San Francisco","group_lon":-122.41999816894531,"id":1625447,"urlname":"LiveMusicSF","group_lat":37.75,"who":"Music Lovers"},
             "status":"past"}],
"meta":{"next":"",
        "method":"Events",
        "total_count":1,
        "link":"https://api.meetup.com/2/events",
        "count":1,
        "description":"Access Meetup events using a group, member, or event id. Events in private groups are available only to authenticated members of those groups. To search events by topic or location, see [Open Events](/meetup_api/docs/2/open_events).",
        "lon":"",
        "title":"Meetup Events v2",
        "url":"https://api.meetup.com/2/events?offset=0&format=json&limited_events=False&event_id=220680184&page=200&fields=&key=3837476f222cc2b6b365513821d38&order=time&desc=false&status=upcoming",
        "id":"",
        "updated":1426396186000,
        "lat":""}}
JSON

modified_third_party_event = <<-JSON
{"results":[{"utc_offset":-25200000,
             "venue":{"country":"us","city":"San Francisco, 94108","address_1":"1111 California St. ","name":"The Masonic ","lon":-122.412956,"id":22529952,"state":"CA","lat":37.791183,"repinned":false},
             "headcount":0,
             "visibility":"public",
             "waitlist_count":0,
             "created":1424581842000,
             "rating":{"count":0,"average":0},
             "maybe_rsvp_count":0,
             "description": "<p>Great band, cheap ticket price, what's not to like?<br/></p>",
             "event_url":"http://www.meetup.com/LiveMusicSF/events/220680184/",
             "yes_rsvp_count":22,
             "name":"Walk the Planet",
             "id":"220680184",
             "time":1426384800000,
             "updated":1526396186000,
             "group":{"join_mode":"open","created":1270427879000,"name":"Live Music San Francisco","group_lon":-122.41999816894531,"id":1625447,"urlname":"LiveMusicSF","group_lat":37.75,"who":"Music Lovers"},
             "status":"past"}],
"meta":{"next":"",
        "method":"Events",
        "total_count":1,
        "link":"https://api.meetup.com/2/events",
        "count":1,
        "description":"Access Meetup events using a group, member, or event id. Events in private groups are available only to authenticated members of those groups. To search events by topic or location, see [Open Events](/meetup_api/docs/2/open_events).",
        "lon":"",
        "title":"Meetup Events v2",
        "url":"https://api.meetup.com/2/events?offset=0&format=json&limited_events=False&event_id=220680184&page=200&fields=&key=3837476f222cc2b6b365513821d38&order=time&desc=false&status=upcoming",
        "id":"",
        "updated":1526396186000,
        "lat":""}}
JSON

third_party_events = <<-JSON
{"results":[{"utc_offset":-28800000,
             "venue":{"zip":"94110",
             "country":"us",
             "city":"San Francisco",
             "address_1":"998 Valencia (at 21st)",
             "name":"Viracocha",
             "lon":-122.421135,
             "id":2583081,
             "state":"CA",
             "lat":37.756908,
             "repinned":false},
             "headcount":0,
             "visibility":"public",
             "waitlist_count":0,
             "created":1425061031000,
             "rating":{"count":1,"average":5},
             "maybe_rsvp_count":0,
             "description":"<p>Come to a night of amazing live music by three female-led bands, at the intimate and beautiful Viracocha in SF!<br/>Wisps and Willows' CD release, Dara Ackerman and full band, and The Kilbanes' debut of their newest Rock Opera. It's going to be a fantastic night.<br/>See article about the coming event on examiner.com here: <br/>Tickets at the door, cash only, $10-20 sliding scale. Doors open at 7pm, show at 8pm.<br/>We can't wait to see you there!<br/>Love, Wisps and Willows, The Kilbanes, and Dara Ackerman</p>",
             "event_url":"http://www.meetup.com/LiveMusicSF/events/220804867/",
             "yes_rsvp_count":5,
             "name":"Wisps & Willows, The Kilbanes, and Dara Ackerman at Viracocha! ",
             "id":"220804867",
             "time":1425700800000,
             "updated":1425936698000,
             "group":{"join_mode":"open","created":1270427879000,"name":"Live Music San Francisco","group_lon":-122.41999816894531,"id":1625447,"urlname":"LiveMusicSF","group_lat":37.75,"who":"Music Lovers"},
             "status":"past"},
           {"utc_offset":-25200000,
             "venue":{"country":"us","city":"San Francisco, 94108","address_1":"1111 California St. ","name":"The Masonic ","lon":-122.412956,"id":22529952,"state":"CA","lat":37.791183,"repinned":false},
             "headcount":0,
             "visibility":"public",
             "waitlist_count":0,
             "created":1424581842000,
             "rating":{"count":0,"average":0},
             "maybe_rsvp_count":0,
             "description": "<p>Great band, cheap ticket price, what's not to like?<br/></p>",
             "event_url":"http://www.meetup.com/LiveMusicSF/events/220680184/",
             "yes_rsvp_count":22,
             "name":"Walk the Moon",
             "id":"220680184",
             "time":1426384800000,
             "updated":1426396186000,
             "group":{"join_mode":"open","created":1270427879000,"name":"Live Music San Francisco","group_lon":-122.41999816894531,"id":1625447,"urlname":"LiveMusicSF","group_lat":37.75,"who":"Music Lovers"},
             "status":"past"}],
"meta":{"next":"",
        "method":"Events",
        "total_count":2,
        "link":"https://api.meetup.com/2/events",
        "count":2,
        "description":"Access Meetup events using a group, member, or event id. Events in private groups are available only to authenticated members of those groups. To search events by topic or location, see [Open Events](/meetup_api/docs/2/open_events).",
        "lon":"",
        "title":"Meetup Events v2",
        "url":"https://api.meetup.com/2/events?offset=0&format=json&limited_events=False&event_id=220804867&page=200&fields=&key=3837476f222cc2b6b365513821d38&order=time&desc=false&status=upcoming",
        "id":"",
        "updated":1425936698000,
        "lat":""}}
JSON

modified_third_party_events = <<-JSON
{"results":[{"utc_offset":-28800000,
             "venue":{"zip":"94110",
             "country":"us",
             "city":"San Francisco",
             "address_1":"998 Valencia (at 21st)",
             "name":"Viracocha",
             "lon":-122.421135,
             "id":2583081,
             "state":"CA",
             "lat":37.756908,
             "repinned":false},
             "headcount":0,
             "visibility":"public",
             "waitlist_count":0,
             "created":1425061031000,
             "rating":{"count":1,"average":5},
             "maybe_rsvp_count":0,
             "description":"<p>Come to a night of amazing live music by three female-led bands, at the intimate and beautiful Viracocha in SF!<br/>Wisps and Willows' CD release, Dara Ackerman and full band, and The Kilbanes' debut of their newest Rock Opera. It's going to be a fantastic night.<br/>See article about the coming event on examiner.com here: <br/>Tickets at the door, cash only, $10-20 sliding scale. Doors open at 7pm, show at 8pm.<br/>We can't wait to see you there!<br/>Love, Wisps and Willows, The Kilbanes, and Dara Ackerman</p>",
             "event_url":"http://www.meetup.com/LiveMusicSF/events/220804867/",
             "yes_rsvp_count":5,
             "name":"Wisps",
             "id":"220804867",
             "time":1425700800000,
             "updated":1725936698000,
             "group":{"join_mode":"open","created":1270427879000,"name":"Live Music San Francisco","group_lon":-122.41999816894531,"id":1625447,"urlname":"LiveMusicSF","group_lat":37.75,"who":"Music Lovers"},
             "status":"past"},
           {"utc_offset":-25200000,
             "venue":{"country":"us","city":"San Francisco, 94108","address_1":"1111 California St. ","name":"The Masonic ","lon":-122.412956,"id":22529952,"state":"CA","lat":37.791183,"repinned":false},
             "headcount":0,
             "visibility":"public",
             "waitlist_count":0,
             "created":1424581842000,
             "rating":{"count":0,"average":0},
             "maybe_rsvp_count":0,
             "description": "<p>Great band, cheap ticket price, what's not to like?<br/></p>",
             "event_url":"http://www.meetup.com/LiveMusicSF/events/220680184/",
             "yes_rsvp_count":22,
             "name":"Walk the Moon",
             "id":"220680184",
             "time":1426384800000,
             "updated":1426396186000,
             "group":{"join_mode":"open","created":1270427879000,"name":"Live Music San Francisco","group_lon":-122.41999816894531,"id":1625447,"urlname":"LiveMusicSF","group_lat":37.75,"who":"Music Lovers"},
             "status":"past"}],
"meta":{"next":"",
        "method":"Events",
        "total_count":2,
        "link":"https://api.meetup.com/2/events",
        "count":2,
        "description":"Access Meetup events using a group, member, or event id. Events in private groups are available only to authenticated members of those groups. To search events by topic or location, see [Open Events](/meetup_api/docs/2/open_events).",
        "lon":"",
        "title":"Meetup Events v2",
        "url":"https://api.meetup.com/2/events?offset=0&format=json&limited_events=False&event_id=220804867&page=200&fields=&key=3837476f222cc2b6b365513821d38&order=time&desc=false&status=upcoming",
        "id":"",
        "updated":1725936698000,
        "lat":""}}
JSON


rsvp = <<-JSON
{"results":[{"venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
            "created":1427259555000,
            "response":"yes",
            "member_photo":{"photo_id":154038622,"photo_link":"http://photos2.meetupstatic.com/photos/member/4/8/b/e/member_154038622.jpeg","thumb_link":"http://photos2.meetupstatic.com/photos/member/4/8/b/e/thumb_154038622.jpeg"},
            "guests":0,
            "member":{"member_id":78662702,"name":"Angela Lau"},
            "rsvp_id":1542837921,
            "mtime":1427259555000,
            "event":{"name":"Nerds on Safari: Market Street","id":"220706208","time":1428735600000,"event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/"},
            "group":{"join_mode":"open","created":1428213717524,"group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668}},
            {"venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
            "created":1424706451000,
            "response":"yes",
            "member_photo":{"photo_id":126229172,"photo_link":"http://photos2.meetupstatic.com/photos/member/c/0/1/4/member_126229172.jpeg","thumb_link":"http://photos2.meetupstatic.com/photos/member/c/0/1/4/thumb_126229172.jpeg"},
            "guests":0,
            "member":{"member_id":82190912,"name":"Amber Hasselbring"},
            "rsvp_id":1537921207,
            "mtime":1424706451000,
            "event":{"name":"Nerds on Safari: Market Street","id":"220706208","time":1428735600000,"event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/"},
            "group":{"join_mode":"open","created":1428213717524,"group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668}},
            {"venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
            "created":1425266317000,
            "response":"yes",
            "member_photo":{"highres_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/highres_218609162.jpeg","photo_id":218609162,"photo_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/member_218609162.jpeg","thumb_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/thumb_218609162.jpeg"},
            "guests":1,
            "member":{"member_id":161571962,"name":"Laura"},
            "rsvp_id":1538991576,
            "mtime":1428016130000,
            "event":{"name":"Nerds on Safari: Market Street","id":"220706208","time":1428735600000,"event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/"},
            "group":{"join_mode":"open","created":1428213717524,"group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668}}],
"meta":{"next":"",
        "method":"RSVPs v2",
        "total_count":3,
        "link":"https://api.meetup.com/2/rsvps",
        "count":3,
        "description":"Query for Event RSVPs by event",
        "lon":"",
        "title":"Meetup RSVPs v2",
        "url":"https://api.meetup.com/2/rsvps?offset=0&format=json&rsvp=yes&event_id=220706208&page=200&fields=&key=2921522134e105851666a55e6d2616&order=event&desc=false",
        "id":"",
        "updated":1428016130000,
        "lat":""}}
JSON


modified_rsvp = <<-JSON
{"results":[{"venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
            "created":1427259555000,
            "response":"yes",
            "member_photo":{"photo_id":154038622,"photo_link":"http://photos2.meetupstatic.com/photos/member/4/8/b/e/member_154038622.jpeg","thumb_link":"http://photos2.meetupstatic.com/photos/member/4/8/b/e/thumb_154038622.jpeg"},
            "guests":0,
            "member":{"member_id":78662702,"name":"Angela Lau"},
            "rsvp_id":1542837921,
            "mtime":1427259555000,
            "event":{"name":"Nerds on Safari: Market Street","id":"220706208","time":1428735600000,"event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/"},
            "group":{"join_mode":"open","created":1428213717524,"group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668}},
            {"venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
            "created":1424706451000,
            "response":"yes",
            "member_photo":{"photo_id":126229172,"photo_link":"http://photos2.meetupstatic.com/photos/member/c/0/1/4/member_126229172.jpeg","thumb_link":"http://photos2.meetupstatic.com/photos/member/c/0/1/4/thumb_126229172.jpeg"},
            "guests":0,
            "member":{"member_id":82190912,"name":"Amber Hasselbring"},
            "rsvp_id":1537921207,
            "mtime":1424706451000,
            "event":{"name":"Nerds on Safari: Market Street","id":"220706208","time":1428735600000,"event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/"},
            "group":{"join_mode":"open","created":1428213717524,"group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668}},
            {"venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
            "created":1425266317000,
            "response":"yes",
            "member_photo":{"highres_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/highres_218609162.jpeg","photo_id":218609162,"photo_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/member_218609162.jpeg","thumb_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/thumb_218609162.jpeg"},
            "guests":4,
            "member":{"member_id":161571962,"name":"Laura"},
            "rsvp_id":1538991576,
            "mtime":1528016130000,
            "event":{"name":"Nerds on Safari: Market Street","id":"220706208","time":1428735600000,"event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/"},
            "group":{"join_mode":"open","created":1428213717524,"group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668}},
            {"venue":{"country":"us","city":"San Francisco","address_1":"1028 Market Street","name":"Sidewalk Prototype in front of The Hall","lon":-122.411324,"id":23697843,"state":"CA","lat":37.781876,"repinned":false},
            "created":1425266317000,
            "response":"yes",
            "member_photo":{"highres_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/highres_218609162.jpeg","photo_id":218609162,"photo_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/member_218609162.jpeg","thumb_link":"http://photos1.meetupstatic.com/photos/member/7/1/e/a/thumb_218609162.jpeg"},
            "guests":3,
            "member":{"member_id":161571955,"name":"Paul"},
            "rsvp_id":1538991588,
            "mtime":1430016130000,
            "event":{"name":"Nerds on Safari: Market Street","id":"220706208","time":1428735600000,"event_url":"http://www.meetup.com/Nature-in-the-City/events/220706208/"},
            "group":{"join_mode":"open","created":1428213717524,"group_lon":-122.44000244140625,"id":8870202,"urlname":"Nature-in-the-City","group_lat":37.7400016784668}}],
"meta":{"next":"",
        "method":"RSVPs v2",
        "total_count":4,
        "link":"https://api.meetup.com/2/rsvps",
        "count":4,
        "description":"Query for Event RSVPs by event",
        "lon":"",
        "title":"Meetup RSVPs v2",
        "url":"https://api.meetup.com/2/rsvps?offset=0&format=json&rsvp=yes&event_id=220706208&page=200&fields=&key=2921522134e105851666a55e6d2616&order=event&desc=false",
        "id":"",
        "updated":1528016130000,
        "lat":""}}
JSON

#401
unauthorized = <<-JSON
{"details":"API requests must be key-signed, oauth-signed, or accompanied by a key: http:\/\/www.meetup.com\/meetup_api\/docs\/#authentication","code":"not_authorized","problem":"You are not authorized to make that request"}
JSON

#400 / 500
error = <<-JSON
{"details":"Perhaps you're missing a required parameter. You can find full documentation of the api here: http://www.meetup.com/meetup_api/docs/","code":"bad_request","problem":"The API request is malformed"}
JSON

#400
not_found = <<-JSON
{"details":"The resource you have requested can not be found","code":"not_found","problem":"Not Found"}
JSON


# DEFAULT FOR ALL CODE
#########################################
FakeWeb.allow_net_connect = false
FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'}])
FakeWeb.allow_net_connect = %r|^https?://127.0.0.1.*|
########################################

# meetup_push.feature
#########################################
Before('@meetup_push') do
  FakeWeb.clean_registry
  FakeWeb.allow_net_connect = true
end

# Set defaults
After('@meetup_push') do
  FakeWeb.allow_net_connect = false
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'}])
  FakeWeb.allow_net_connect = %r|^https?://127.0.0.1.*|
end
#########################################


# meetup_pull.feature
#########################################
Before('@meetup_pull') do
  FakeWeb.clean_registry
  FakeWeb.allow_net_connect = false
end

# Set defaults
After('@meetup_pull') do
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'}])
  FakeWeb.allow_net_connect = %r|^https?://127.0.0.1.*|
end

Before('@successful_pull_meetup') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
end

Before('@failed_pull_meetup') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => error, :content_type => 'application/json', :status => ["500", "Internal Server Error"]}])

end

Before('@repeated_unchanged_pull_meetup') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'},
                                                                                           {:body => events, :content_type => 'application/json'}])
end

Before('@repeated_changed_pull_meetup') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'},
                                                                                           {:body => modified_events, :content_type => 'application/json'}])
end
########################################


# meetup_pull_3rd_by_organization.feature
#######################################
Before('@meetup_pull_3rd_by_organization') do
  FakeWeb.clean_registry
  FakeWeb.allow_net_connect = false
end

# Set defaults
After('@meetup_pull_3rd_by_organization') do
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'}])
  FakeWeb.allow_net_connect = %r|^https?://127.0.0.1.*|
end

Before('@search_events_by_group') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
end

Before('@successful_pull_third_events') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
end

Before('@failed_pull_third_events') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => error, :content_type => 'application/json', :status => ["500", "Internal Server Error"]})
end

Before('@repeated_unchanged_pull_third_events') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
end

Before('@repeated_changed_pull_third_events') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, [{:body => third_party_events, :content_type => 'application/json'},
                                                                                         {:body => modified_third_party_events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, [{:body => third_party_events, :content_type => 'application/json'},
                                                                                         {:body => modified_third_party_events, :content_type => 'application/json'}])
end
#######################################

# meetup_pull_3rd_by_id.feature
#######################################
Before('@meetup_pull_3rd_by_id') do
  FakeWeb.clean_registry
  FakeWeb.allow_net_connect = false
end

# Set defaults
After('@meetup_pull_3rd_by_id') do
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'}])
  FakeWeb.allow_net_connect = %r|^https?://127.0.0.1.*|
end

Before('@search_event_by_id') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
end

Before('@successful_pull_third_event') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
  #FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
end

Before('@failed_pull_third_event') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, [{:body => third_party_event, :content_type => 'application/json'},
                                                                                        {:body => error, :content_type => 'application/json', :status => ["500", "Internal Server Error"]}])
  #FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => error, :content_type => 'application/json', :status => ["500", "Internal Server Error"]})
end

Before('@repeated_unchanged_pull_third_event') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
  #FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
end

Before('@repeated_changed_pull_third_event') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, [{:body => third_party_event, :content_type => 'application/json'},
                                                                                        {:body => third_party_event, :content_type => 'application/json'},
                                                                                        {:body => modified_third_party_event, :content_type => 'application/json'},
                                                                                        {:body => modified_third_party_event, :content_type => 'application/json'}])
end
#######################################


# meetup_pull_rsvp.feature
######################################
Before('@meetup_pull_rsvp') do
  FakeWeb.clean_registry
  FakeWeb.allow_net_connect = false
end

# Set defaults
After('@meetup_pull_rsvp') do
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_urlname=.*|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=\w+,.+$|, {:body => third_party_events, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*event_id=[^,]+$|, {:body => third_party_event, :content_type => 'application/json'})
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'}])
  FakeWeb.allow_net_connect = %r|^https?://127.0.0.1.*|
end

Before('@successful_pull_meetup') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
end

Before('@successful_pull_rsvp') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'}])
end

Before('@failed_pull_rsvp') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, {:body => error, :content_type => 'application/json', :status => ["500", "Internal Server Error"]})
end

Before('@repeated_unchanged_pull_rsvp') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'},
                                                                      {:body => rsvp, :content_type => 'application/json'}])
end

Before('@repeated_changed_pull_rsvp') do
  FakeWeb.clean_registry
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/events\?.*group_id=8870202.*|, [{:body => events, :content_type => 'application/json'}])
  FakeWeb.register_uri(:get, %r|https://api\.meetup\.com/2/rsvps\?|, [{:body => rsvp, :content_type => 'application/json'},
                                                                      {:body => modified_rsvp, :content_type => 'application/json'}])
end
######################################